This is chapter 4. commited in master branch.